### che-server example requests (VS Code REST Client / IntelliJ HTTP Client)
###
### Local testing:
### - Start server: ./run/start-local-dev.sh
### - For auth in local mode you can use the "test Bearer" format supported by che-server:
###     Authorization: Bearer <userid>:<username>
### - Namespace endpoints also require SERVICE_ACCOUNT_TOKEN for local runs:
###     export SERVICE_ACCOUNT_TOKEN="$(oc whoami -t)"

@baseUrl = http://localhost:8080/api
@username = johndoe
@userid = user123
@bearer = {{userid}}:{{username}}
@basic = am9obmRvZTp1c2VyMTIz

### Provision Namespace (Bearer Token)
POST {{baseUrl}}/kubernetes/namespace/provision
Authorization: Bearer {{bearer}}
Content-Type: application/json

### Provision Namespace (Basic Auth)
POST {{baseUrl}}/kubernetes/namespace/provision
### basic is base64("{{username}}:{{userid}}")
Authorization: Basic {{basic}}
Content-Type: application/json

### List Namespaces
GET {{baseUrl}}/kubernetes/namespace
Authorization: Bearer {{bearer}}

### Provision for Different User
POST {{baseUrl}}/kubernetes/namespace/provision
Authorization: Bearer user456:janedoe
Content-Type: application/json

### Test Unauthorized Request (should fail)
POST {{baseUrl}}/kubernetes/namespace/provision
Content-Type: application/json

### Resolve Factory from URL
POST {{baseUrl}}/factory/resolver
Authorization: Bearer {{bearer}}
Content-Type: application/json

{
  "url": "https://raw.githubusercontent.com/eclipse/che/main/devfile.yaml"
}

### Resolve Factory with Validation
POST {{baseUrl}}/factory/resolver?validate=true
Authorization: Bearer {{bearer}}
Content-Type: application/json

{
  "url": "https://example.com/devfile.yaml"
}

### Refresh Factory Token
POST {{baseUrl}}/factory/token/refresh?url=https://github.com/user/repo
Authorization: Bearer {{bearer}}
Content-Type: application/json

### System State
GET {{baseUrl}}/system/state

### Resolve Factory without Parameters (should fail)
POST {{baseUrl}}/factory/resolver
Authorization: Bearer {{bearer}}
Content-Type: application/json

{}

### Test Invalid Route (should return 404)
GET {{baseUrl}}/invalid/route
Authorization: Bearer {{userid}}:{{username}}

